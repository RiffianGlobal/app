import{T as x,w as j,a as S,c as h,s as k,f as O,C}from"./index-k2DQ7ALJ.js";import{a0 as z,x as i,q as m,n as l,j as c,l as y,m as v,U as P,e as D,a2 as L,O as _,J as f}from"./vendor-tqqTBR6w.js";const N=(e={})=>({pageNum:1,pageSize:10,hasMore:!0,...e}),B=":host{background-color:transparent!important}:host::part(inner){display:flex;height:2rem;width:100%;align-items:center;justify-content:center}@media (min-width: 1024px){:host::part(inner){height:2.5rem}}";var E=Object.defineProperty,I=Object.getOwnPropertyDescriptor,u=(e,t,r,a)=>{for(var s=a>1?void 0:a?I(t,r):t,o=e.length-1,n;o>=0;o--)(n=e[o])&&(s=(a?n(t,r,s):n(s))||s);return a&&s&&E(t,r,s),s};let p=class extends z(x(B),{persistent:!0,rootMargin:"30px"}){constructor(){super(...arguments),this.pageSize=5,this.page=1,this.mode="scroll",this.pending=!1,this.firstLoad=!0,this.empty=!1,this.nomore=!1,this.class="",this.loadmore=()=>{if(!this.canLoad)return;const{pageSize:e,page:t,mode:r}=this;this.emit("cc"),this.emit("loadmore",{pageSize:e,page:t,mode:r})},this.onObserved=()=>{this.scrollMode&&this.loadmore()}}get canLoad(){return!this.pending&&!this.nomore&&!this.empty&&!this.firstLoad}get scrollMode(){return this.mode==="scroll"}connectedCallback(){super.connectedCallback()}render(){return i`<div class="ui-pagination w-full flex justify-center items-center mt-4 ${m(this.$c([{nomore:this.nomore,"pointer-events-none !bg-transparent":!this.canLoad||this.scrollMode,scrollMode:this.scrollMode},this.class]))}"><div part="inner" @click="${this.loadmore}">${l(this.empty,()=>i`<slot name="empty"></slot>`,()=>i`${l(this.nomore,()=>i`<slot name="nomore"></slot>`,()=>i`${l(this.pending,()=>i`<slot name="loading"><loading-icon type="block"></loading-icon></slot>`,()=>i`${l(!this.scrollMode&&!this.firstLoad,()=>i`<slot><ui-link>Load more</ui-link></slot>`)}`)}`)}`)}</div></div>`}};u([c({type:Number})],p.prototype,"pageSize",2);u([c({type:Number})],p.prototype,"page",2);u([c()],p.prototype,"mode",2);u([c()],p.prototype,"pending",2);u([c({type:Boolean})],p.prototype,"firstLoad",2);u([c({type:Boolean})],p.prototype,"empty",2);u([c({type:Boolean})],p.prototype,"nomore",2);u([c()],p.prototype,"class",2);p=u([y("ui-pagination")],p);var q=Object.defineProperty,T=Object.getOwnPropertyDescriptor,M=(e,t,r,a)=>{for(var s=a>1?void 0:a?T(t,r):t,o=e.length-1,n;o>=0;o--)(n=e[o])&&(s=(a?n(t,r,s):n(s))||s);return a&&s&&q(t,r,s),s};let $=class extends x(""){render(){return this.chg.val==0?this.chg.per:i`<span class="${m({"text-green-500":this.chg.stat=="up","text-red-500":this.chg.stat=="down"})}">${this.chg.per}</span>`}};M([c({type:Object})],$.prototype,"chg",2);$=M([y("chg-stat")],$);const U=".subject-name{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (min-width: 1024px){.subject-name{font-size:1rem;line-height:1.5rem}.subject-name.limit{max-width:10rem}}.subject-img{height:3.5rem;width:3.5rem;cursor:pointer;border-radius:.5rem}.subject-lines{display:flex;flex-direction:column;gap:.25rem;line-height:1}.subject-lines .subject-line1{display:flex;height:1.5rem;align-items:center;line-height:1}.subject-play{font-size:1.25rem;line-height:1.75rem;line-height:1;opacity:.85}.subject-play:hover{opacity:1}";var R=Object.defineProperty,V=Object.getOwnPropertyDescriptor,g=(e,t,r,a)=>{for(var s=a>1?void 0:a?V(t,r):t,o=e.length-1,n;o>=0;o--)(n=e[o])&&(s=(a?n(t,r,s):n(s))||s);return a&&s&&R(t,r,s),s};let d=class extends x(U){constructor(){super(...arguments),this.bindScreen=new v(this,P),this.bindWallet=new v(this,j),this.bindWeekly=new v(this,S),this.bindCharts=new v(this,h),this.paging=!1,this.brief=!0,this.pageSize=10,this.moreSubjects=[],this.morePending=!1,this.ts=0,this.err="",this.pagination=N({pageNum:2,pageSize:this.pageSize}),this.hasMore=!0,this.fetch=async(e=!1)=>{if(!(this.morePending&&!e)&&!(this.paging&&!this.hasMore)){this.err="",this.morePending=!0;try{const t={cate:h.cate};if(this.pagination){const{pageSize:a,pageNum:s}=this.pagination;Object.assign(t,{first:a,skip:(s-1)*a})}const{subjects:r}=await k(t);this.paging?(this.moreSubjects=[...this.moreSubjects,...r],this.hasMore=r.length>=this.pagination.pageSize,this.pagination.pageNum++):this.moreSubjects=[...r]}catch(t){this.err=t.message||t.msg||t}finally{this.morePending=!1,this.ts++}}},this.loadmore=()=>{this.fetch()},this.fullItemMobi=e=>i`<div class="w-full overflow-hidden flex gap-x-2" @click="${t=>this.go2(t,e)}"><div class="w-[3.25rem] h-[3.25rem] mr-2 rounded-lg"><img-loader src="${e.image}" class="w-[3.25rem] rounded-lg"></img-loader></div><div class="subject-lines flex-auto overflow-hidden"><div class="subject-line1"><p class="subject-name ${m({limit:this.brief})}">${e.name}</p><a href="${e.uri}" class="flex-none ml-1.5" target="_blank"><i class="subject-play mdi mdi-play-circle-outline"></i></a></div><div class="text-xs text-gray-400/80"><span class="mr-1 text-gray-400/60">Price:</span>${e.cooked.price}</div></div><div class="subject-lines num flex-initial !w-12 text-sm items-end"><span class="subject-line1">${e.cooked.total}</span> <span class="text-xs"><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`,this.go2=(e,t)=>{var r;e.preventDefault(),e.stopPropagation(),this.disabled?D.emit("connect-wallet"):((r=e.target)==null?void 0:r.tagName)=="I"?window.open(t.uri,"_blank"):L(`/track/${t.id}`)},this.headerEle=()=>this.brief?i`${l(!this.isMobi,()=>i`<div class="w-8">Rank</div>`)}<div class="flex-shrink">Collection</div><div class="flex-auto"></div><div class="num flex-auto w-32">Volume</div>`:i`${l(!this.isMobi,()=>i`<div class="w-16">Index</div>`)}<div class="flex-auto">Name</div>${l(!this.isMobi,()=>i`<div class="flex-none w-40">Uploaded</div>`)}<div class="num flex-none w-24">Volume</div>${l(!this.isMobi,()=>i`<div class="num flex-none w-24">Price</div><div class="num flex-none w-24">24H</div>`)}`,this.itemEle=(e,t)=>this.brief?i`<div class="item flex items-center" @click="${r=>this.go2(r,e)}">${l(!this.isMobi,()=>i`<div class="flex-none w-8 text-center text-sm font-light opacity-70">${t+1}</div>`)}<div class="subject-img flex-shrink flex justify-center"><img-loader .src="${e.cooked.src}" class="w-14 rounded-lg"></img-loader></div><div class="subject-lines flex-auto overflow-hidden"><div class="subject-line1"><p class="subject-name ${m({limit:this.brief})}">${e.name}</p><a href="${e.uri}" class="flex-none ml-1.5" target="_blank"><i class="subject-play mdi mdi-play-circle-outline"></i></a></div>${l(this.brief,()=>i`<div class="text-xs text-gray-400/80"><span class="mr-1 text-gray-400/60">Price:</span>${e.cooked.price}</div>`)}</div><div class="subject-lines num flex-initial !w-12 text-sm items-end"><span class="subject-line1">${e.cooked.total}</span> <span class="text-xs"><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`:i`${l(!this.isMobi,()=>i`<div class="item flex items-center hover_cursor-pointer" @click="${r=>this.go2(r,e)}"><div class="flex-none w-16 pl-4 text-sm font-light opacity-75">${t+1} ${l(this.subjects.length>3&&t<3,()=>i`<i class="mdi mdi-fire text-red-400"></i>`)}</div><div class="flex-auto flex overflow-hidden"><div class="w-[3.25rem] h-[3.25rem] mr-4 rounded-lg"><img-loader src="${e.cooked.src}" class="w-[3.25rem] h-[3.25rem] rounded-lg"></img-loader></div><div class="truncate"><p class="subject-name subject-line1 lg_text-base truncate w-full">${e.name}</p><i class="subject-play mdi mdi-play-circle"></i></div></div><div class="flex-none w-40 text-xs text-gray-300/60">${O(e.createdAt)}</div><div class="flex-none w-24 text-right text-sm"><span>${e.cooked.total}</span></div><div class="flex-none w-24 text-right text-sm"><span>${e.cooked.price}</span></div><div class="flex-none w-24 text-right text-sm leading-none"><span><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`,()=>i`${this.fullItemMobi(e)}`)}`}get disabled(){return!j.account}get isMobi(){return P.isMobi}get scrollMode(){return"scroll"}get empty(){return h.inited&&!h.subjects.length}get loading(){return h.chartPending&&!h.subjects.length}get subjects(){return this.empty?[]:h.subjects.concat(this.moreSubjects)}render(){return i`<div role="list" class="ui-list gap-2 ${m(this.$c([this.morePending?"loading":"hover"]))}"><div class="flex header border-bottom">${this.headerEle()}</div>${l(this.loading,()=>i`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>i`${_(this.subjects,(e,t)=>i`${this.itemEle(e,t)}`)} ${l(this.paging,()=>i`<ui-pagination .nomore="${this.err}" mode="${this.scrollMode}" .firstLoad="${!1}" .pending="${this.morePending}" @loadmore="${this.loadmore}"></ui-pagination>`,()=>i`<ui-link dense class="w-full justify-center" href="/charts">More</ui-link>`)}`)}</div>`}};g([c({type:Boolean})],d.prototype,"paging",2);g([c({type:Boolean})],d.prototype,"brief",2);g([c({type:Number})],d.prototype,"pageSize",2);g([f()],d.prototype,"moreSubjects",2);g([f()],d.prototype,"morePending",2);g([f()],d.prototype,"ts",2);g([f()],d.prototype,"err",2);g([f()],d.prototype,"pagination",2);g([f()],d.prototype,"hasMore",2);d=g([y("top-charts")],d);const W=":host{display:inline-flex;gap:2rem}";var A=Object.defineProperty,H=Object.getOwnPropertyDescriptor,w=(e,t,r,a)=>{for(var s=a>1?void 0:a?H(t,r):t,o=e.length-1,n;o>=0;o--)(n=e[o])&&(s=(a?n(t,r,s):n(s))||s);return a&&s&&A(t,r,s),s};let b=class extends x(W){constructor(){super(...arguments),this.bindChart=new v(this,h),this.cate="top",this.route=!1,this.goto=(e,t)=>{this.route||(e.stopImmediatePropagation(),e.preventDefault(),h.cate=t)}}render(){return i`${_(C,e=>i`<ui-link href="/charts/${e.key}" @click="${t=>this.goto(t,e.key)}" nav dense exact class="${m({"exact-active":h.cate===e.key})}">${e.title}</ui-link>`)}`}};w([c({type:String})],b.prototype,"cate",2);w([c({type:Boolean})],b.prototype,"route",2);b=w([y("charts-cate")],b);export{N as p,U as s};
